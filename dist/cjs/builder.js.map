{"version":3,"file":"builder.js","names":["constant","_interopRequireWildcard","require","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","builder","schedules","listRules","forEach","schedule","ruleSequence","period","start","end","splitStart","split","dateStart","repeat","concat","monthStart","scheduleMonths","find","month","id","parseInt","name","splitEnd","dateEnd","monthEnd","scheduleMonth","push","monthRange","months","length","join","dayRange","days","day","scheduleDay","scheduleDays","time","status","scheduleStatus","open"],"sources":["../../src/builder.ts"],"sourcesContent":["import * as constant from \"./constant\";\nimport { Schedule } from \"./schedules\";\n\n/**\n * Créé une horaire au format opening_hours à partir d'une liste d'objets horaires\n * @param {Array<Schedule>} schedules\n * @returns {string | null} opening_hour si horaires valident, null sinon\n */\nexport function builder(schedules: Array<Schedule>): string | null {\n  const listRules: Array<String> = [];\n\n  schedules.forEach((schedule: Schedule) => {\n    const ruleSequence = [];\n\n    // Période\n    if (schedule.period.start && schedule.period.end) {\n      // Début période\n      const splitStart = schedule.period.start.split('-');\n      let dateStart = schedule.period.repeat ? '' : `${splitStart[0]} `;\n      const monthStart = constant.scheduleMonths.find((month) => month.id === parseInt(splitStart[1], 10));\n      if(!monthStart) return null;\n      dateStart += `${monthStart.name} ${splitStart[2]}`;\n\n      // Fin période\n      const splitEnd = schedule.period.end.split('-');\n      let dateEnd = schedule.period.repeat ? '' : `${splitEnd[0]} `;\n      const monthEnd = constant.scheduleMonths.find((scheduleMonth) => scheduleMonth.id === parseInt(splitEnd[1], 10));\n      if(!monthEnd) return null;\n      dateEnd += `${monthEnd.name} ${splitEnd[2]}`;\n\n      ruleSequence.push(`${dateStart} - ${dateEnd}`);\n    }\n\n    // Mois\n    const monthRange: Array<String> = [];\n    schedule.months.forEach((month) => {\n      const scheduleMonth = constant.scheduleMonths.find((scheduleMonth) => scheduleMonth.id === month);\n      if(!scheduleMonth) return null;\n      monthRange.push(scheduleMonth.name);\n    });\n    if (monthRange.length) ruleSequence.push(monthRange.join(','));\n\n    // Jour\n    const dayRange: Array<String> = [];\n    schedule.days.forEach((day) => {\n      const scheduleDay = constant.scheduleDays.find((scheduleDay) => scheduleDay.id === day)\n      if(!scheduleDay) return null;\n      dayRange.push(scheduleDay.name);\n    });\n    if (dayRange.length) ruleSequence.push(dayRange.join(','));\n\n    // Heure minute\n    if (schedule.time.start && schedule.time.end) {\n      ruleSequence.push(`${schedule.time.start}-${schedule.time.end}`);\n    }\n\n    // Status\n    const status = constant.scheduleStatus.find((status) => status.id === schedule.time.open);\n    if(!status) return null;\n    ruleSequence.push(status.name);\n\n    listRules.push(ruleSequence.join(' '));\n  });\n\n  return listRules.join(';');\n}\n"],"mappings":"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","ignoreList":[]}